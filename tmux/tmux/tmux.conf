# Main tmux configuration file
# Split into multiple files for better organization

# ============================================
# Core Settings
# ============================================

# update environment variables on attach
set-option -g update-environment "KITTY_LISTEN_ON KITTY_WINDOW_ID WEZTERM_PANE WEZTERM_UNIX_SOCKET"

# ensure terminal starts with its own colour scheme (defined below)
# set -g default-terminal "xterm-256color"
set -s default-terminal xterm-256color
set-option -as terminal-overrides ",*-256color:Tc"

# If off, the client is switched to the most recently active of the remaining sessions
set-option -g detach-on-destroy on

# use Vi style key bindings to move around command line mode
set-option -g status-keys vi

# use Vi style key bindings to move around copy mode
setw -g mode-keys vi

# enable focus events for better vim/neovim integration
set-option -g focus-events on

# remove delay when pressing esc in Vim
set -sg escape-time 10

# prevent tmux from renaming the tab when processes change
# e.g. if you're in a directory which is a git repo and you fire up Pry then
# tmux would first rename the tab to 'java' (for Pry) then 'git' when exiting Pry, then finally back to 'zsh'
set-option -g allow-rename off

# use basename of current path for automatic window naming
set-option -g automatic-rename-format "#{b:pane_current_path}"

# tells tmux up front what shell to expect
# set-option -g default-shell /bin/zsh

# set base index to 0
set -g base-index 0

# increase scrollback lines
set -g history-limit 30000

# renumber windows automatically after removing a window
# prevents my OCD and means I don't have to manually run {move|swap}-window
set-option -g renumber-windows on

# it causes tmux to resize a window based on the smallest client actually viewing it,
# not on the smallest one attached to the entire session.
setw -g aggressive-resize on

# mouse works as expected
set -g mouse on

# main pane width
setw -g main-pane-width 100

# set window size to the smallest attached session
set-window-option -g window-size smallest

# ============================================
# Source configuration files
# ============================================

# Load keybindings
source-file ~/.config/tmux/keybindings.conf

# Load status bar configuration
source-file ~/.config/tmux/status-bar.conf

# Load color scheme
source-file ~/.config/tmux/colors.conf

# Load platform-specific configuration
if-shell '[ "$SSH_CONNECTION" ]' {
  source-file ~/.config/tmux/platform-linux.conf
}

if-shell '$(uname | grep -q Darwin)' {
  source-file ~/.config/tmux/platform-macos.conf
}

# Load plugins (must be last)
source-file ~/.config/tmux/plugins.conf
