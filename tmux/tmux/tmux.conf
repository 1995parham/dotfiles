# vim: set ft=tmux:
# Main tmux configuration file
# Split into multiple files for better organization

# ============================================
# Core Settings
# ============================================

# update environment variables on attach
set-option -g update-environment "KITTY_LISTEN_ON KITTY_WINDOW_ID WEZTERM_PANE WEZTERM_UNIX_SOCKET"

# ensure terminal starts with 256 color support and true color
set -s default-terminal xterm-256color
set-option -as terminal-overrides ",*-256color:Tc"

# switch to most recently active session when detaching (can be overridden per platform)
set-option -g detach-on-destroy on

# use vi-style key bindings in command mode and copy mode
set-option -g status-keys vi
setw -g mode-keys vi

# enable focus events for better vim/neovim integration
set-option -g focus-events on

# reduce escape time delay for better vim/neovim experience
set -sg escape-time 10

# prevent automatic window renaming based on running process
set-option -g allow-rename off

# use basename of current path for automatic window naming
set-option -g automatic-rename-format "#{b:pane_current_path}"

# start window indexing at 0
set -g base-index 0

# increase scrollback buffer size
set -g history-limit 30000

# automatically renumber windows when one is closed
set-option -g renumber-windows on

# resize window based on smallest client viewing it (not smallest attached to session)
setw -g aggressive-resize on

# enable mouse support
set -g mouse on

# set default width for main pane in main-horizontal/main-vertical layouts
setw -g main-pane-width 100

# constrain window size to smallest client viewing it
set-window-option -g window-size smallest

# ============================================
# Source configuration files
# ============================================

# Load keybindings
source-file ~/.config/tmux/keybindings.conf

# Load status bar configuration
source-file ~/.config/tmux/status-bar.conf

# Load color scheme
source-file ~/.config/tmux/colors.conf

# Load platform-specific configuration
if-shell '[ "$SSH_CONNECTION" ]' {
  source-file ~/.config/tmux/platform-linux.conf
}

if-shell '$(uname | grep -q Darwin)' {
  source-file ~/.config/tmux/platform-macos.conf
}

# Load plugins (must be last)
source-file ~/.config/tmux/plugins.conf
